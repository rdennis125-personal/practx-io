// param namePrefix string
// @allowed([
//   'westus2'
// ])
// param location string = 'westus2'
// param tags object = {}
// param functionSku string = 'Y1'
// param tenantId string
// @description('Optional raw XML policy applied at the API Management global scope.')
// param apimPolicyContent string = ''
// 
// module insights 'modules/appInsights.bicep' = {
//   name: 'appInsights'
//   params: {
//     name: '${namePrefix}-ai'
//     location: location
//     tags: tags
//   }
// }
// 
// module serviceBus 'modules/serviceBus.bicep' = {
//   name: 'serviceBus'
//   params: {
//     name: '${namePrefix}-sb'
//     location: location
//     tags: tags
//   }
// }
// 
// module apiManagement '../modules/apim.bicep' = {
//   name: 'apiManagement'
//   params: {
//     namePrefix: namePrefix
//     location: location
//     tags: tags
//     policyContent: apimPolicyContent
//   }
// }
// 
// module functionApp 'modules/functionApp.bicep' = {
//   name: 'functionApp'
//   params: {
//     name: '${namePrefix}-func'
//     location: location
//     planSku: functionSku
//     appInsightsConnectionString: insights.outputs.connectionString
//     tags: tags
//   }
// }
// 
// module keyVault 'modules/keyVault.bicep' = {
//   name: 'keyVault'
//   params: {
//     name: '${namePrefix}-kv'
//     location: location
//     tags: tags
//     tenantId: tenantId
//     functionPrincipalId: functionApp.outputs.principalId
//   }
// }
// 
// output functionAppName string = functionApp.outputs.name
// output serviceBusNamespace string = serviceBus.outputs.namespaceName
// output keyVaultName string = keyVault.outputs.name
// output appInsightsName string = insights.outputs.name
// output apiManagementName string = apiManagement.outputs.apimName
// output apiManagementGatewayUrl string = apiManagement.outputs.gatewayUrl
// output apiManagementDeveloperPortalUrl string = apiManagement.outputs.developerPortalUrl
